@using X.PagedList.Mvc.Core;
@using X.PagedList;
@model AuctionHouse.Models.View.AuctionPreviewModel; 
@{
    String imageData;
    int i = 0;
}

    <div class="album py-5 bg-light" style="border: 3px solid black; border-radius: 15px;">
        <div class="container">
            <div class="row">
                @foreach (var item in @Model.auctions)
                {
                    imageData = Convert.ToBase64String(item.image);

                    
                
                <div class="col-xl-3">
                <div class="card mb-4 box-shadow">
                        <img class="card-img-top" src="data:image/png;base64,@imageData"  alt="Card image cap" style="height: 225px; width: 100%; display: block;">
                        <div class="card-body" style="height: 75px; text-align: center;">
                            <div class="card-title" style="font-weight: bold;">@item.name</div>
                        </div>
                        <div class="list-group list-group-flush">
                            @if(item.state.Equals("Open"))
                            {
                                i = i +1;
                                <input type="hidden" id="@Html.Raw("closeTime"+@i)" value="@item.closeDate.ToString("yyyy,MM,d,H,m,s")"/>
                                <div id="@Html.Raw("time"+@i)" class="list-group-item" style="text-align: center;">--:--:--:--</div>

                            }
                            else
                            {
                                <div class="list-group-item" style="text-align: center;">@item.state</div>
                            }
                            


                            <div class="list-group-item" style="text-align: center;">@item.currentPrice</div>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-md btn-outline-success">Bid (+10)</button>
                                </div>
                                <div class="text-muted">
                                    @if (@item.winner!=null){
                                        @Html.Raw(@item.winner.UserName);
                                    }
                                    else{
                                        @Html.Raw("No bidders yet");
                                    }

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                }



            </div>
        </div>
    </div>

    <div class="row justify-content-center pt-5">
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                @if (Model.currentPage > 1)
                {
                    int previousPage = @Model.currentPage-1;
                    <li class="page-item">
                        <button class="page-link" aria-label="Previous" onclick="jumpToPage('@previousPage')">
                            <span aria-hidden="true"> @Html.Raw("<") </span>
                            <span class="sr-only">Previous</span>
                        </button>
                    </li>   
                }


                <li class="page-item disabled"><button class="page-link">Page @Model.currentPage of @Model.numOfPages.</button></li>

                @for(i = 1; i<=Model.numOfPages;i++)
                {
                    if(i==Model.currentPage)
                    {
                        <li class="page-item active">
                            <button class="page-link">@i</button>
                        </li>
                    }
                    else
                    {
                        <li class="page-item">
                            <button class="page-link" onclick="jumpToPage('@i')">@i</button>
                        </li>

                    }

                }

                @if(Model.currentPage < Model.numOfPages)
                {
                    int nextPage = @Model.currentPage+1;
                    <li class="page-item">
                        <button class="page-link" aria-label="Next" onclick="jumpToPage('@nextPage')">
                            <span aria-hidden="true"> @Html.Raw(">") </span>
                            <span class="sr-only">Next</span>
                        </button>
                    </li>
                }

            </ul>
        </nav>
    </div>

